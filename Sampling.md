## 抽样方法

- [目录](#)
	- [保持方法和随机二次抽样](#保持方法和随机二次抽样)
	- [交叉验证](#交叉验证)
	- [随机抽样](#随机抽样)
	- [分层抽样Stratified sampling](#分层抽样Stratified sampling)
	- [整体抽样](#整体抽样)
	- [系统抽样](#系统抽样)
	- [比较](#比较)

### 保持方法和随机二次抽样

+ **保持**
	+ 给定数据随机地划分成两个独立的集合：训练集和检验集。通常，2/3的数据分配到训练集，1/3的数据分配到检验集。
	
+ **随机二次抽样**
	+ 保持方法的一种变形，它将保持方法重复k次，总准确率估计取每次迭代准确率的平均值。

### 交叉验证
+ **K折交叉验证**
	+ 初始数据随机地划分成k个互不相交的子集：D1, D2, ..., Dk，每个折大小相等。训练和检验k次，第i次迭代，分区Di用做检验集，其余分区用于训练模型。总共训练得到k个模型，准确率是k次迭代正确分类的样本总数除以总样本数。

### 随机抽样
> **原理：**按等概率原则直接从含有N个元素的总体中抽取n个元素组成样本（N>n）。这种方法简便易学，常用的办法就是抽签了。不过，这适合总体单位较少时使用。


### 分层抽样Stratified sampling
> **原理：**分层抽样法也叫类型抽样法，它是从一个可以分成不同子总体（层）的总体中，按规定的比例从不同层中随机抽取样本的方法。
> 建议使用**分层10-折交叉验证**估计准确率，因为它具有相对较低的偏差和方差。
> **优点：**样本的代表性好，每个层中样本的分布与初始数据中大致相同，抽样误差较小。
> **缺点：**抽样手续较简单随机抽样还要繁杂些。

```python
def stratified(id_y_uq, nfold=5):
    
	# 提取出id_y_uq中标签为0和1的数据
    id_y_uq0 = id_y_uq[id_y_uq.y==0].sample(frac=1)
    id_y_uq1 = id_y_uq[id_y_uq.y==1].sample(frac=1)
    
	# 新生成一个列'g'，按照nfold分别对标签为0和1的数据进行分层
    id_y_uq0['g'] = [i%nfold for i in range(len(id_y_uq0))]
    id_y_uq1['g'] = [i%nfold for i in range(len(id_y_uq1))]
    id_y_uq_ = pd.concat([id_y_uq0, id_y_uq1])
    
	# 将分层后的数据按照原始数据的"id"进行合并
    id_y_ = pd.merge(id_y[['id']], id_y_uq_, how='left', on='id')
    
    train_idx_list = []
    valid_idx_list = []
	
    for i in range(nfold):
        train_idx = id_y_[id_y_.g!=i].index
        train_idx_list.append(train_idx) # 列表中不包含与索引值相同的分层数据中的索引
        valid_idx = id_y_[id_y_.g==i].index
        valid_idx_list.append(valid_idx) # 列表中包含与索引值相同的分层数据中的索引
    
	# 返回分层后的索引
    return train_idx_list, valid_idx_list

train_idx_list, valid_idx_list = stratified(10)
	
```


### 整体抽样
> **原理：**整群抽样又称聚类抽样，是将总体中各单位归并成若干个互不交叉、互不重复的集合，称之为群。然后以群为抽样单位抽取样本的一种抽样方式。应用整群抽样时，要求各群有较好的代表性，即群内各单位的差异要大，群间差异要小。


### 系统抽样
> **原理：**系统抽样亦称为机械抽样、等距抽样。当总体中的个体数较多时，采用简单随机抽样显得较为费事。这时，可将总体分成均衡的几个部分，然后按照预先定出的规则，从每一部分抽取一个个体，得到所需要的样本，这种抽样叫做系统抽样。


### 比较
>  随机抽样就是抽签，用于数量较小的；分层抽样就是一组样品中有几中性质不同的，按性质来分；系统抽样就是按100一隔或者50一隔来分。

+ **整体抽样和分层抽样的区别**
	+  分层抽样要求各层之间的差异很大，层内个体或单元差异小，而整群抽样要求群与群之间的差异比较小，群内个体或单元差异大；
	+ 分层抽样的样本是从每个层内抽取若干单元或个体构成，而整群抽样则是要么整群抽取，要么整群不被抽取。
